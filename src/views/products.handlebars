<h1 class="page-title">Lista de Productos</h1>
<!-- Título de la página -->

<!-- Select para ordenar por precio -->
<label for="sort">Ordenar por precio:</label>
<select id="sort" onchange="sortProducts()">
  <option value="">--Seleccione--</option>
  <option value="asc" {{#ifEquals selectedSort "asc"}}selected{{/ifEquals}}>Menor a Mayor</option>
  <option value="desc" {{#ifEquals selectedSort "desc"}}selected{{/ifEquals}}>Mayor a Menor</option>
  <!-- Se mantiene la opción seleccionada según el valor de selectedSort -->
</select>

<!-- Select para filtrar por categoría -->
<label for="category">Filtrar por categoría:</label>
<select id="category" onchange="filterByCategory()">
  <option value="">--Todas--</option>
  <option value="madera" {{#ifEquals selectedCategory "madera"}}selected{{/ifEquals}}>Madera</option>
  <option value="calabaza" {{#ifEquals selectedCategory "calabaza"}}selected{{/ifEquals}}>Calabaza</option>
  <option value="ceramica" {{#ifEquals selectedCategory "ceramica"}}selected{{/ifEquals}}>Cerámica</option>
  <!-- Se mantiene la opción seleccionada según selectedCategory -->
</select>

<div class="products-container">
  {{#each products}}
  <div class="product-item" data-id="{{this._id}}">
    <!-- Cada producto guarda su id en un atributo data-id -->
    <h3>{{this.title}}</h3>
    <!-- Nombre del producto -->
    <p>{{this.description}}</p>
    <!-- Descripción del producto -->
    <p><b>Precio:</b> ${{this.price}}</p>
    <!-- Precio del producto -->

    <a href="/products/{{this._id}}" class="btn-ver-mas">Ver más</a>
    <!-- Enlace para ir al detalle del producto -->

    <button onclick="addToCart('{{this._id}}')">Agregar al carrito</button>
    <!-- Botón para agregar al carrito llamando a la función addToCart -->
  </div>
  {{/each}}
</div>

<!-- Paginación -->
<div class="pagination">
  {{#if hasPrevPage}}<a href="{{prevLink}}">Anterior</a>{{/if}}
  Página {{page}} de {{totalPages}}
  {{#if hasNextPage}}<a href="{{nextLink}}">Siguiente</a>{{/if}}
  <!-- Enlaces a página anterior y siguiente si existen, mostrando la página actual -->
</div>

<div id="mini-cart">
  <h2>Carrito (<span id="cart-count">0</span> items)</h2>
  <!-- Contenedor del mini carrito que muestra la cantidad total de productos -->
</div>

<script>
function sortProducts() {
  const sortValue = document.getElementById("sort").value;
  // Tomo el valor seleccionado en el select de orden
  const url = new URL(window.location.href);
  // Obtengo la URL actual
  if (sortValue) url.searchParams.set("sort", sortValue);
  // Si hay un valor, lo agrego a la query string
  else url.searchParams.delete("sort");
  // Si no hay valor, elimino el parámetro sort de la URL
  window.location.href = url.toString();
  // Recargo la página con la nueva URL
}

function filterByCategory() {
  const categoryValue = document.getElementById("category").value;
  // Tomo el valor seleccionado en el select de categoría
  const url = new URL(window.location.href);
  if (categoryValue) url.searchParams.set("category", categoryValue);
  else url.searchParams.delete("category");
  window.location.href = url.toString();
  // Recargo la página con la nueva URL según categoría
}

// Aquí va todo tu código de carrito (addToCart, renderMiniCart, etc.) igual que antes
// Esto incluye funciones para agregar productos, actualizar cantidades, eliminar productos y renderizar el mini carrito
</script>
